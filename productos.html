<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Catálogo de Productos | Camila Shop</title>
  <link rel="stylesheet" href="css/estilos.css">
</head>
<body>
  <!-- NAVBAR -->
  <header>
    <nav class="navbar">
      <div class="logo-container">
        <img src="logo.png" alt="Camila Shop Logo" class="logo">
        <span class="brand">Camila <span class="brand-blue">Shop</span></span>
      </div>
      <ul class="nav-links">
        <li><a href="index.html">Inicio</a></li>
        <li><a href="productos.html" class="active">Productos</a></li>
        <li><a href="sobre-nosotros.html">Sobre Nosotros</a></li>
        <li><a href="contacto.html">Contacto</a></li>
      </ul>
    </nav>
  </header>

  <!-- MAIN CATÁLOGO -->
  <main class="productos-main" style="margin-top:90px;">
    <h1 style="color:var(--violeta);margin-bottom:10px;">Catálogo de Productos</h1>
    <p style="color:#555;max-width:500px;margin:0 auto 26px auto;">Encontrá todos nuestros productos. Usá el buscador o filtrá por nombre, código o rubro.</p>

    <div class="filtros" style="margin-bottom:22px;display:flex;gap:10px;flex-wrap:wrap;justify-content:center;">
      <input id="buscador" class="filtro-input" type="search" placeholder="Buscar por nombre o código...">
      <select id="filtroRubro" class="filtro-select">
        <option value="">Cualquier rubro</option>
      </select>
    </div>

    <div id="catalogo" class="catalogo-grid"></div>

    <div id="paginado" style="margin-top:34px;text-align:center;"></div>
  </main>

  <!-- FOOTER -->
  <footer>
    © 2025 Camila Shop | Todos los derechos reservados.
  </footer>

  <!-- SCRIPT -->
  <script>
    const SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRNGCPSH5C80N8aS9rAbIqlTsrKHF5lGxy5yvGa9ek0WVL7Rjit6EQiZEk2736TV1gbPJKaSvlrxu-z/pub?gid=0&single=true&output=csv';
    const IMG_PATH = 'img/';
    const PAGE_SIZE = 24;

    let productos = [], filtrados = [];
    let pagina = 1, totalPaginas = 1;

    async function cargarProductos() {
      const res = await fetch(SHEET_URL);
      const csv = await res.text();
      productos = csv.trim().split('\n').slice(1).map(row => {
        const [codigo, nombre, precio, stock, rubro] = row.split(',');
        return {
          codigo: codigo.trim(),
          nombre: nombre.trim(),
          precio: precio.trim(),
          stock: stock.trim(),
          rubro: (rubro || '').trim()
        };
      });

      // Poblar el select con rubros únicos y ordenados
      const rubrosUnicos = [...new Set(productos
  .map(p => p.rubro)
  .filter(r => r && /[a-zA-ZáéíóúÁÉÍÓÚ]/.test(r)) // solo rubros con letras
)].sort();


      const selectRubro = document.getElementById('filtroRubro');
      rubrosUnicos.forEach(r => {
        const opt = document.createElement('option');
        opt.value = r;
        opt.textContent = r.toUpperCase();
        selectRubro.appendChild(opt);
      });

      filtrados = productos;
      renderCatalogo();
      renderPaginado();
    }

    function renderCatalogo() {
      const cont = document.getElementById('catalogo');
      cont.innerHTML = '';
      if (filtrados.length === 0) {
        cont.innerHTML = '<p style="color:#c62828;font-weight:600;">No se encontraron productos.</p>';
        return;
      }
      totalPaginas = Math.ceil(filtrados.length / PAGE_SIZE);
      const desde = (pagina - 1) * PAGE_SIZE;
      const hasta = Math.min(desde + PAGE_SIZE, filtrados.length);

      for (let i = desde; i < hasta; i++) {
        const p = filtrados[i];
        let imgSrc = IMG_PATH + p.codigo + '.jpg';
        cont.innerHTML += `
          <div class="product-card">
            <img class="product-img" src="${imgSrc}" alt="${p.nombre}" loading="lazy"
              onerror="this.onerror=null;this.src='${IMG_PATH}${p.codigo}.png';">
            <div class="product-title">${p.nombre}</div>
            <div class="product-precio">$${Number(p.precio).toLocaleString('es-AR')}</div>
            <div class="product-stock${p.stock == 0 ? ' agotado' : ''}">
              ${p.stock == 0 ? 'Agotado' : 'Stock: ' + p.stock}
            </div>
          </div>
        `;
      }
    }

    function renderPaginado() {
      const pagCont = document.getElementById('paginado');
      if (totalPaginas <= 1) { pagCont.innerHTML = ''; return; }
      let html = '';
      for (let i = 1; i <= totalPaginas; i++) {
        html += `<button onclick="cambiarPagina(${i})" style="background:${i===pagina?'var(--violeta)':'#e2d5f6'};color:${i===pagina?'#fff':'#8246ab'};border:none;border-radius:7px;padding:7px 13px;margin:0 3px;cursor:pointer;font-weight:600;">${i}</button>`;
      }
      pagCont.innerHTML = html;
    }

    window.cambiarPagina = function(num) {
      pagina = num;
      renderCatalogo();
      renderPaginado();
      window.scrollTo({top:130,behavior:'smooth'});
    }

    function aplicarFiltros() {
      const q = document.getElementById('buscador').value.trim().toLowerCase();
      const rubroSel = document.getElementById('filtroRubro').value;
      filtrados = productos.filter(p => {
        const matchTexto = p.nombre.toLowerCase().includes(q) || p.codigo.toLowerCase().includes(q);
        const matchRubro = rubroSel ? p.rubro === rubroSel : true;
        return matchTexto && matchRubro;
      });
      pagina = 1;
      renderCatalogo();
      renderPaginado();
    }

    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('buscador').addEventListener('input', aplicarFiltros);
      document.getElementById('filtroRubro').addEventListener('change', function() {
        document.getElementById('buscador').value = '';
        aplicarFiltros();
      });
      cargarProductos();
    });
  </script>
</body>
</html>


