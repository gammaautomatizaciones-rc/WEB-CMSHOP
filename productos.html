<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Catálogo de Productos | Camila Shop</title>
  <link rel="stylesheet" href="css/estilos.css">
</head>
<body>
  <!-- NAVBAR -->
  <header>
    <nav class="navbar">
      <div class="logo-container">
        <img src="logo.png" alt="Camila Shop Logo" class="logo">
        <span class="brand">Camila <span class="brand-blue">Shop</span></span>
      </div>
      <!-- Botón hamburguesa -->
      <button class="menu-toggle" aria-label="Abrir menú">&#9776;</button>
      <ul class="nav-links">
        <li><a href="index.html">Inicio</a></li>
        <li><a href="productos.html" class="active">Productos</a></li>
        <li><a href="sobre-nosotros.html">Sobre Nosotros</a></li>
        <li><a href="contacto.html">Contacto</a></li>
        <li><a href="consultar-puntos.html">Consultar Puntos</a></li>
      </ul>
    </nav>
  </header>

  <!-- MAIN CATÁLOGO -->
  <main class="productos-main" style="margin-top:90px;">
    <h1 style="color:var(--violeta);margin-bottom:10px;">Catálogo de Productos</h1>
    <p style="color:#555;max-width:500px;margin:0 auto 26px auto;">Encontrá todos nuestros productos. Usá el buscador o filtrá por nombre o código.</p>

    <div class="filtros" style="margin-bottom:22px;">
      <input id="buscador" class="filtro-input" type="search" placeholder="Buscar por nombre o código...">
    </div>

    <div id="catalogo" class="catalogo-grid"></div>

    <div id="paginado" style="margin-top:34px;text-align:center;"></div>
  </main>

  <!-- FOOTER -->
  <footer>
    © 2025 Camila Shop | Todos los derechos reservados.
  </footer>

  <!-- SCRIPT OPTIMIZADO -->
  <script>
    // CONFIGURACIÓN
    const SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRNGCPSH5C80N8aS9rAbIqlTsrKHF5lGxy5yvGa9ek0WVL7Rjit6EQiZEk2736TV1gbPJKaSvlrxu-z/pub?gid=0&single=true&output=csv';
    const IMG_PATH = 'img/'; // carpeta donde subis las imágenes (nombre = código.jpg o png)

    // PARÁMETROS PAGINADO
    const PAGE_SIZE = 24;
    let productos = [], filtrados = [];
    let pagina = 1, totalPaginas = 1;

    // Cargar productos del sheet (csv)
    async function cargarProductos() {
      const res = await fetch(SHEET_URL);
      const csv = await res.text();
      productos = csv.trim().split('\n').slice(1).map(row => {
        const [codigo, nombre, precio, stock] = row.split(',');
        return { codigo: codigo.trim(), nombre: nombre.trim(), precio: precio.trim(), stock: stock.trim() };
      });
      filtrados = productos;
      renderCatalogo();
      renderPaginado();
    }

    // Renderizar productos paginados
    function renderCatalogo() {
      const cont = document.getElementById('catalogo');
      cont.innerHTML = '';
      if (filtrados.length === 0) {
        cont.innerHTML = '<p style="color:#c62828;font-weight:600;">No se encontraron productos.</p>';
        return;
      }
      totalPaginas = Math.ceil(filtrados.length / PAGE_SIZE);
      const desde = (pagina - 1) * PAGE_SIZE;
      const hasta = Math.min(desde + PAGE_SIZE, filtrados.length);

      for (let i = desde; i < hasta; i++) {
        const p = filtrados[i];
        // Admite .jpg o .png para la imagen
        let imgSrc = IMG_PATH + p.codigo + '.jpg';
        // Si querés que busque png si no encuentra jpg, usá un pequeño truco con onerror (fallback)
        cont.innerHTML += `
          <div class="product-card">
            <img class="product-img" src="${imgSrc}" alt="${p.nombre}" loading="lazy"
              onerror="this.onerror=null;this.src='${IMG_PATH}${p.codigo}.png';">
            <div class="product-title">${p.nombre}</div>
            <div class="product-precio">$${Number(p.precio).toLocaleString('es-AR')}</div>
            <div class="product-stock${p.stock == 0 ? ' agotado' : ''}">
              ${p.stock == 0 ? 'Agotado' : 'Stock: ' + p.stock}
            </div>
          </div>
        `;
      }
    }

    // Renderizar paginado
    function renderPaginado() {
      const pagCont = document.getElementById('paginado');
      if (totalPaginas <= 1) { pagCont.innerHTML = ''; return; }
      let html = '';
      for (let i = 1; i <= totalPaginas; i++) {
        html += `<button onclick="cambiarPagina(${i})" style="background:${i===pagina?'var(--violeta)':'#e2d5f6'};color:${i===pagina?'#fff':'#8246ab'};border:none;border-radius:7px;padding:7px 13px;margin:0 3px;cursor:pointer;font-weight:600;">${i}</button>`;
      }
      pagCont.innerHTML = html;
    }

    // Cambio de página
    window.cambiarPagina = function(num) {
      pagina = num;
      renderCatalogo();
      renderPaginado();
      window.scrollTo({top:130,behavior:'smooth'});
    }

    // Filtro buscador
    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('buscador').addEventListener('input', function() {
        const q = this.value.trim().toLowerCase();
        filtrados = productos.filter(p =>
          p.nombre.toLowerCase().includes(q) || p.codigo.toLowerCase().includes(q)
        );
        pagina = 1;
        renderCatalogo();
        renderPaginado();
      });
      cargarProductos();

      // Menú hamburguesa
      const menuToggle = document.querySelector('.menu-toggle');
      const navLinks = document.querySelector('.nav-links');
      if (menuToggle && navLinks) {
        menuToggle.addEventListener('click', function () {
          navLinks.classList.toggle('open');
          menuToggle.classList.toggle('active');
        });
        navLinks.querySelectorAll('a').forEach(link => {
          link.addEventListener('click', () => {
            navLinks.classList.remove('open');
            menuToggle.classList.remove('active');
          });
        });
      }
    });
  </script>
</body>
</html>
